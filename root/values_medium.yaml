# MEDIUM CLUSTER: All apps enabled (inherited from base values.yaml)
# Add Kyverno policy for local-path access mode mutation

# Medium & Small clusters add local-path storage policy for RWX→RWO conversion
# Medium & Small clusters add local-path storage policy for RWX→RWO conversion
enabledApps:
  - aim-cluster-model-source
  - airm
  - amd-gpu-operator
  - amd-gpu-operator-config
  - appwrapper
  - argocd
  - argocd-config
  - cert-manager
  - cluster-auth
  - cluster-auth-config
  - cnpg-operator
  - external-secrets
  - external-secrets-config
  - gateway-api
  - gitea
  - gitea-config
  - kaiwo
  - kaiwo-config
  - kaiwo-crds
  - keda
  - kedify-otel
  - keycloak
  - kgateway
  - kgateway-config
  - kgateway-crds
  - kserve
  - kserve-crds
  - kueue
  - kueue-config
  - kuberay-operator
  - kyverno
  - kyverno-config
  - kyverno-policies-storage-local-path
  - metallb
  - minio-operator
  - minio-tenant
  - minio-tenant-config
  - openbao
  - openbao-config
  - opentelemetry-operator
  - otel-lgtm-stack
  - prometheus-crds
  - rabbitmq


apps:
  # Modular Kyverno policy applications (only the storage-local-path addition)
  kyverno-policies-storage-local-path:
    namespace: kyverno
    path: kyverno-policies/storage-local-path
    source: clusterForge
    syncOptions:
      - CreateNamespace=true
    ignoreDifferences: []
    wave: 26  # Deploy after base policies
    syncWave:
      - group: kyverno.io
        kind: ClusterPolicy

  argocd:
    valuesObject:
      applicationSet:
        replicas: 1
      controller:
        replicas: 1
        resources:
          limits:
            cpu: "2000m"
            memory: "4Gi"
          requests:
            cpu: "500m" 
            memory: "1Gi"
      redis-ha:
        enabled: false
        redis:
          resources:
            limits:
              cpu: "1000m"
              memory: "2Gi"
            requests:
              cpu: "250m"
              memory: "512Mi"
      repoServer:
        replicas: 1
        resources:
          limits:
            cpu: "1000m" 
            memory: "2Gi"
          requests:
            cpu: "250m"
            memory: "512Mi"
      server:
        replicas: 1
        resources:
          limits:
            cpu: "500m"
            memory: "1Gi"
          requests:
            cpu: "125m"
            memory: "256Mi"

  minio-tenant:
    valuesObject:
      tenant:
        buckets:
          - name: default-bucket
            objectLock: true
          - name: models
            objectLock: true
          - name: datasets
            objectLock: false
        pools:
          - name: pool-0
            servers: 1
            size: 2Ti
            storageClassName: local-path
            volumesPerServer: 2
        resources:
          limits:
            cpu: "4000m"
            memory: "8Gi"
          requests:
            cpu: "1000m"
            memory: "2Gi"
        lifecycle:
          - id: team-data-transition
            status: Enabled
            transition:
              days: 30
              storageClass: IA

  openbao:
    valuesObject:
      server:
        ha:
          enabled: false
          replicas: 1
          raft:
            enabled: false
        dataStorage:
          size: 5Gi
          storageClass: local-path
        resources:
          limits:
            cpu: "1000m"
            memory: "2Gi"
          requests:
            cpu: "250m"
            memory: "512Mi"

  prometheus:
    valuesObject:
      prometheus:
        prometheusSpec:
          retention: 15d
          retentionSize: 20GB
          resources:
            limits:
              cpu: "2000m"
              memory: "4Gi"
            requests:
              cpu: "500m"
              memory: "1Gi"
          storageSpec:
            volumeClaimTemplate:
              spec:
                accessModes:
                  - ReadWriteOnce
                storageClassName: local-path
                resources:
                  requests:
                    storage: 25Gi

  grafana:
    valuesObject:
      replicas: 1
      resources:
        limits:
          cpu: "1000m"
          memory: "2Gi"
        requests:
          cpu: "250m"
          memory: "512Mi"
      persistence:
        enabled: true
        size: 5Gi
        storageClassName: local-path
        accessModes:
          - ReadWriteOnce
