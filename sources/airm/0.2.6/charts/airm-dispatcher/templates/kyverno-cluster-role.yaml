# Copyright Â© Advanced Micro Devices, Inc., or its affiliates.
#
# SPDX-License-Identifier: MIT

# These are additional cluster roles needed by kyverno background controller to be able to
# create rolebindings in namespaces.
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: kyverno:airm-policy-roles
  labels:
    rbac.kyverno.io/aggregate-to-background-controller: "true"
rules:
  - apiGroups: ["rbac.authorization.k8s.io"]
    resources: ["clusterroles", "rolebindings"]
    verbs: ["get", "list", "watch"]
  - apiGroups: ["rbac.authorization.k8s.io"] # allow kyverno to bind clusterroles via rolebindings
    resources: ["clusterroles"]
    verbs: ["bind"]
---
# These are additional cluster roles needed by kyverno reports controller to be able to
# manage custom resources for reporting
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: kyverno:airm-reports-policy-roles
  labels:
    rbac.kyverno.io/aggregate-to-reports-controller: "true"
rules:
  - apiGroups: ["kaiwo.silogen.ai"]
    resources: ["kaiwojobs", "kaiwoservices"]
    verbs: ["get", "list", "watch"]
  - apiGroups: ["aim.silogen.ai"]
    resources: ["aimservices"]
    verbs: ["get", "list", "watch"]
